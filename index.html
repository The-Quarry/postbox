<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Guernsey Postboxes</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100vh; }
    .panel {
      position: absolute; z-index: 1000; left: 10px; top: 10px;
      background: #fff; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,.15);
      padding: 12px; font: 14px/1.35 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; width: 320px; max-width: calc(100% - 20px);
    }
    .panel h1 { font-size: 16px; margin: 0 0 8px; }
    .row { display: flex; gap: 8px; margin: 6px 0; flex-wrap: wrap; }
    .row input[type="search"], .row input[type="text"] { flex: 1; padding: 6px 8px; border: 1px solid #ddd; border-radius: 8px; }
    .row button { padding: 6px 10px; border: 1px solid #ddd; border-radius: 8px; background: #f7f7f7; cursor: pointer; }
    .toggles label { margin-right: 12px; }
    .legend { display: flex; gap: 10px; margin: 6px 0 0; flex-wrap: wrap; }
    .nearest { margin-top: 8px; border-top: 1px solid #eee; padding-top: 8px; max-height: 210px; overflow: auto; }
    .nearest h2 { font-size: 14px; margin: 0 0 6px; }
    .nearest .item { padding: 6px 0; border-bottom: 1px dashed #eee; cursor: pointer; }
    .nearest .item:last-child { border-bottom: 0; }
    .nearest small { color:#555; }
    .leaflet-control-attribution { font-size: 11px !important; }
    #hidePanel {
      position: absolute; top: 8px; right: 8px;
      border: 0; background: none; font-size: 18px; cursor: pointer;
    }
    #showPanel {
      position: absolute; top: 10px; left: 10px; z-index: 1001;
      padding: 6px 10px; border-radius: 8px; border: 1px solid #ccc;
      background: #fff; cursor: pointer; display: none;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Show button appears when panel is hidden -->
  <button id="showPanel">☰ Show</button>

  <div id="panel" class="panel">
    <button id="hidePanel">✕</button>
    <h1>Guernsey Postboxes</h1>
    <div class="row">
      <input id="q" type="search" placeholder="Find postbox by name/address/ID…" />
    </div>
    <div class="row">
      <input id="addr" type="text" placeholder="Find closest boxes to you" />
      <button id="find">Find</button>
      <button id="myloc">Use my location</button>
      <button id="clear">Clear</button>
    </div>
    <div class="row toggles">
      <label><input type="checkbox" id="showRetained" checked> Retained</label>
      <label><input type="checkbox" id="showClosure" checked> Proposed closure</label>
    </div>
    <div class="legend">
      <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="20" viewBox="0 0 24 32" style="vertical-align:middle;margin-right:4px">
          <rect x="6" y="2" width="12" height="24" rx="2" ry="2" fill="#e74c3c" stroke="black" stroke-width="1"/>
          <rect x="8" y="6" width="8" height="2" fill="black"/>
          <rect x="10" y="22" width="4" height="6" fill="#e74c3c" stroke="black" stroke-width="1"/>
        </svg>
        Proposed closure
      </span>
      <span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="20" viewBox="0 0 24 32" style="vertical-align:middle;margin-right:4px">
          <rect x="6" y="2" width="12" height="24" rx="2" ry="2" fill="#2ecc71" stroke="black" stroke-width="1"/>
          <rect x="8" y="6" width="8" height="2" fill="black"/>
          <rect x="10" y="22" width="4" height="6" fill="#2ecc71" stroke="black" stroke-width="1"/>
        </svg>
        Retained
      </span>
    </div>
    <div class="nearest" id="nearest">
      <h2>Closest postboxes</h2>
      <div id="nearestList"><small>Enter an address/postcode or use your location.</small></div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <script>
    // Panel toggle
    const panel   = document.getElementById('panel');
    const hideBtn = document.getElementById('hidePanel');
    const showBtn = document.getElementById('showPanel');

    hideBtn.addEventListener('click', () => {
      panel.style.display = 'none';
      showBtn.style.display = 'block';
    });

    showBtn.addEventListener('click', () => {
      panel.style.display = 'block';
      showBtn.style.display = 'none';
    });

    // … keep the rest of your existing JS (map init, markers, search, geocode, etc.) here …
  </script>
</body>
</html>